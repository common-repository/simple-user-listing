(()=>{"use strict";var e,s={647:()=>{const e=window.wp.blocks,s=window.React,t=window.wp.i18n,l=window.wp.data,r=window.wp.coreData,n=window.wp.blockEditor,i=window.wp.components,a=window.wp.hooks,o=window.wp.compose,u=(0,o.createHigherOrderComponent)((e=>t=>{const{name:l,attributes:r}=t;if("simple-user-listing/directory-block"!=l)return(0,s.createElement)(e,{...t});const{columns:n,className:i=""}=r,a=i.includes("is-style-grid")&&n?`columns-${n}`:"";return(0,s.createElement)(e,{...t,className:a})}),"addCustomBlockGridLayoutClass");function c(e){const{attributes:l,setAttributes:r}=e,{className:n="",columns:a}=l;return n.includes("is-style-grid")?(0,s.createElement)(i.PanelBody,{title:(0,t.__)("Layout","simple-user-listing")},(0,s.createElement)(i.RangeControl,{label:(0,t.__)("Columns","simple-user-listing"),value:a,onChange:e=>r({columns:e}),min:1,max:4})):null}(0,a.addFilter)("editor.BlockListBlock","simple-user-listing/grid-classes",u);const m=window.wp.url;function d({value:e,onChange:l}){var n;const{record:a,hasResolved:o}=(0,r.useEntityRecord)("simple-user-listing/v1","user-roles"),u=null!==(n=a?.registered_roles)&&void 0!==n?n:[];if(!o)return(0,s.createElement)(i.Spinner,null);const c=(e?e.toString().split(","):[]).reduce(((e,s)=>{const t=u[s];return t&&e.push(t),e}),[]),m=u?Object.values(u):[];return(0,s.createElement)(i.FormTokenField,{__experimentalExpandOnFocus:!0,label:(0,t.__)("Roles","simple-user-listing"),value:c,suggestions:m,onChange:e=>{const s=Array.from(e.reduce(((e,s)=>{const t=(e=>{const s=Object.entries(u).find((([s,t])=>t===e));return s?s[0]:null})(s);return t&&e.add(t),e}),new Set));l(s.join(","))},messages:{added:(0,t.__)("Role added","simple-user-listing"),remove:(0,t.__)("Remove role","simple-user-listing"),removed:(0,t.__)("Role removed","simple-user-listing")},__experimentalShowHowTo:!1})}const p=window.wp.element,g=window.wp.htmlEntities,_={_fields:"id,name",context:"edit"},h=(e,s)=>{const t=s?.id||e?.find((e=>e.name===s))?.id;if(t)return t;const l=s.toLocaleLowerCase();return e?.find((e=>e.name.toLocaleLowerCase()===l))?.id};function v({value:e,onChange:n}){const[a,u]=(0,p.useState)([]),[c,m]=(0,p.useState)([]),[d,v]=(0,p.useState)([]),[E,b]=(0,p.useState)(""),w=(0,o.useDebounce)(b,500);(0,p.useEffect)((()=>{const s=e?e.toString().split(",").map((e=>+e)):[];m(s)}),[e]);const{searchResults:y,searchHasResolved:f}=(0,l.useSelect)((e=>{if(!E)return{searchResults:[],searchHasResolved:!0};const{getEntityRecords:s,hasFinishedResolution:t}=e(r.store),l={..._,per_page:25,search:E,exclude:c};return{searchResults:s("root","user",l),searchHasResolved:t("getEntityRecords",["root","user",l])}}),[E,c]),x=(0,l.useSelect)((e=>{if(!c?.length)return[];const{getEntityRecords:s}=e(r.store);return s("root","user",{..._,per_page:-1,include:c})}),[c]);return(0,p.useEffect)((()=>{if(c?.length||v([]),!x?.length)return;const e=x.map((e=>({id:e.id,value:e.name})));v(e)}),[c,x]),(0,p.useEffect)((()=>{f&&u(y?.map((e=>e.name)))}),[y,f]),(0,s.createElement)(i.FormTokenField,{label:(0,t.__)("Users","simple-user-listing"),value:d,onInputChange:w,onChange:e=>{const s=Array.from(e.reduce(((e,s)=>{const t=h(y,s);return t&&e.add(t),e}),new Set));u([]),n(s.join(","))},suggestions:a,displayTransform:g.decodeEntities,messages:{added:(0,t.__)("User added","simple-user-listing"),remove:(0,t.__)("Remove User","simple-user-listing"),removed:(0,t.__)("User removed","simple-user-listing")},__experimentalShowHowTo:!1})}const E=[{
// translators: label for ordering users by name.
label:(0,t.__)("Display name","simple-user-listing"),value:"name"},{label:(0,t.__)("User name","simple-user-listing"),value:"login"},{
// translators: label for ordering users by User ID
label:(0,t.__)("User ID","simple-user-listing"),value:"id"}],b=[{
// translators: label for ordering users in ascending order.
label:(0,t.__)("Ascending, ex: A → Z","simple-user-listing"),value:"asc"},{
// translators: label for ordering users in descending order.
label:(0,t.__)("Descending, ex: Z → A","simple-user-listing"),value:"desc"}];function w({attributes:e,setAttributes:l}){const{excludeRoles:r,excludeUsers:n,order:a,orderBy:o,showAllUsers:u,queryId:c,roles:p,users:g,usersPerPage:_}=e;return(0,s.createElement)(s.Fragment,null,(0,s.createElement)(i.PanelBody,{title:(0,t.__)("User Query Settings","simple-user-listing")},(0,s.createElement)(i.RangeControl,{label:(0,t.__)("Users per page","simple-user-listing"),value:_,onChange:e=>l({usersPerPage:e}),min:1,max:20}),(0,s.createElement)(i.SelectControl,{__nextHasNoMarginBottom:!0,label:(0,t.__)("Order by","simple-user-listing"),value:o,options:E,onChange:e=>{l({orderBy:e})}}),(0,s.createElement)(i.SelectControl,{__nextHasNoMarginBottom:!0,label:(0,t.__)("Order","simple-user-listing"),value:a,options:b,onChange:e=>{l({order:e})}}),(0,s.createElement)(i.TextControl,{label:(0,t.__)("Query ID","simple-user-listing"),help:(0,t.__)("Custom `query_id` for advanced usage.","simple-user-listing"),value:c||"",onChange:e=>{let s=(0,m.cleanForSlug)(e);l({queryId:s})}}),(0,s.createElement)(i.ToggleControl,{label:(0,t.__)("Display all users","simple-user-listing"),help:(0,t.__)("Toggle to show all site users. Disable to limit display to certain users.","simple-user-listing"),checked:u,onChange:()=>{l({showAllUsers:!u})}})),!u&&(0,s.createElement)(i.__experimentalToolsPanel,{label:(0,t.__)("Filter Users","simple-user-listing"),resetAll:()=>{l({excludeRoles:!1,excludeUsers:!1,roles:"",users:""})}},(0,s.createElement)(i.__experimentalToolsPanelItem,{hasValue:()=>!!p,label:(0,t.__)("By roles","simple-user-listing"),onDeselect:()=>l({excludeRoles:!1,roles:""})},(0,s.createElement)(d,{value:p,onChange:e=>l({roles:e})}),(0,s.createElement)(i.ToggleControl,{label:(0,t.__)("Exclude roles","simple-user-listing"),checked:r,onChange:()=>l({excludeRoles:!r})})),(0,s.createElement)(i.__experimentalToolsPanelItem,{hasValue:()=>!!g,label:(0,t.__)("By user","simple-user-listing"),onDeselect:()=>l({excludeUsers:!1,users:""})},(0,s.createElement)(v,{value:g,onChange:e=>l({users:e})}),(0,s.createElement)(i.ToggleControl,{label:(0,t.__)("Exclude users","simple-user-listing"),checked:n,onChange:()=>l({excludeUsers:!n})}))))}const y=()=>(0,s.createElement)("div",{className:"author-search"},(0,s.createElement)("h2",null,(0,t.__)("Search users by name","simple-user-listing")),(0,s.createElement)("form",{method:"get",action:""},(0,s.createElement)("label",{htmlFor:"as",className:"assistive-text"},(0,t.__)("Search","simple-user-listing")),(0,s.createElement)("input",{type:"text",className:"field",name:"as",placeholder:(0,t.__)("Search users","simple-user-listing"),readOnly:!0}),(0,s.createElement)("input",{type:"submit",className:"button button-primary",value:(0,t.__)("Search users","simple-user-listing"),readOnly:!0}))),f=({user:e})=>(0,s.createElement)("div",{id:"user-1",className:"author-block"},(0,s.createElement)("img",{alt:"",src:e.avatar_urls[96],srcSet:`${e.avatar_urls[96]} 2x`,className:"avatar avatar-90 photo",loading:"lazy",width:"90",height:"90"}),(0,s.createElement)("h2",{className:"author-name"},e.name),e.description&&(0,s.createElement)("p",{className:"author-description"},(0,g.decodeEntities)(e.description)));(0,l.dispatch)("core").addEntities([{baseURL:"/simple-user-listing/v1/user-roles",label:(0,t.__)("User Roles","simple-user-listing"),kind:"simple-user-listing/v1",name:"user-roles"}]);const x=JSON.parse('{"UU":"simple-user-listing/directory-block"}');(0,e.registerBlockType)(x.UU,{edit:function({attributes:e,setAttributes:l}){const{excludeRoles:a,excludeUsers:o,order:u,orderBy:m,showAllUsers:d,roles:p,users:g,usersPerPage:_}=e;let h={orderby:m,order:u,per_page:_};d||(p&&(a?h.roles__not_in=p:h.roles=p),g&&(o?h.exclude=g:h.include=g));const{records:v,hasResolved:E}=(0,r.useEntityRecords)("root","user",h);return(0,s.createElement)(s.Fragment,null,(0,s.createElement)(n.InspectorControls,null,(0,s.createElement)(w,{attributes:e,setAttributes:l}),(0,s.createElement)(c,{attributes:e,setAttributes:l})),(0,s.createElement)("div",{...(0,n.useBlockProps)()},(0,s.createElement)(y,null),(0,s.createElement)("div",{className:"user-list-wrap"},E?v&&v.length>0?v.map((e=>(0,s.createElement)(f,{key:e.id,user:e}))):(0,s.createElement)("h2",null,(0,t.__)("No users found","simple-user-listing")):(0,s.createElement)(i.Spinner,null))))}})}},t={};function l(e){var r=t[e];if(void 0!==r)return r.exports;var n=t[e]={exports:{}};return s[e](n,n.exports,l),n.exports}l.m=s,e=[],l.O=(s,t,r,n)=>{if(!t){var i=1/0;for(c=0;c<e.length;c++){for(var[t,r,n]=e[c],a=!0,o=0;o<t.length;o++)(!1&n||i>=n)&&Object.keys(l.O).every((e=>l.O[e](t[o])))?t.splice(o--,1):(a=!1,n<i&&(i=n));if(a){e.splice(c--,1);var u=r();void 0!==u&&(s=u)}}return s}n=n||0;for(var c=e.length;c>0&&e[c-1][2]>n;c--)e[c]=e[c-1];e[c]=[t,r,n]},l.o=(e,s)=>Object.prototype.hasOwnProperty.call(e,s),(()=>{var e={233:0,605:0};l.O.j=s=>0===e[s];var s=(s,t)=>{var r,n,[i,a,o]=t,u=0;if(i.some((s=>0!==e[s]))){for(r in a)l.o(a,r)&&(l.m[r]=a[r]);if(o)var c=o(l)}for(s&&s(t);u<i.length;u++)n=i[u],l.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return l.O(c)},t=globalThis.webpackChunksimple_user_listing=globalThis.webpackChunksimple_user_listing||[];t.forEach(s.bind(null,0)),t.push=s.bind(null,t.push.bind(t))})();var r=l.O(void 0,[605],(()=>l(647)));r=l.O(r)})();